<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Food Cart â€“ TheMealDB</title>
  <style>
    body{font-family:Arial,sans-serif;background:#f4f4f4;margin:0;padding:16px}
    h2{margin:10px 0}
    .top-cart{display:flex;gap:12px;background:#fff;padding:10px;border-radius:8px;overflow-x:auto}
    .top-cart img{width:45px;height:45px;border-radius:50%;object-fit:cover}
    .count{font-weight:bold}
    .search{margin:15px 0}
    .search input{padding:8px;width:220px}
    .search button{padding:8px}
    .list{display:grid;grid-template-columns:repeat(auto-fill,minmax(320px,1fr));gap:16px}
    .card{background:#fff;border-radius:10px;overflow:hidden;box-shadow:0 2px 6px rgba(0,0,0,.1)}
    .card img{width:100%;height:200px;object-fit:cover}
    .card-body{padding:12px}
    .card-body p{margin:4px 0;font-size:14px}
    .card-body button{margin-right:6px;padding:6px 10px}
    .disabled{opacity:.6;pointer-events:none}
    .modal{display:none;position:fixed;inset:0;background:rgba(0,0,0,.6);align-items:center;justify-content:center}
    .modal-content{background:#fff;padding:20px;border-radius:10px;width:360px;max-height:90vh;overflow:auto}
    .modal-content img{width:100%;border-radius:8px;margin-bottom:10px}
  </style>
</head>
<body>

<h2>Total Cart: <span id="count" class="count">0</span>/7</h2>
<div id="cart" class="top-cart"></div>

<div class="search">
  <input id="searchInput" placeholder="Search food name" />
  <button onclick="searchMeal()">Search</button>
</div>

<div id="mealList" class="list"></div>

<div id="modal" class="modal" onclick="closeModal()">
  <div class="modal-content" onclick="event.stopPropagation()">
    <img id="mImg">
    <h3 id="mName"></h3>
    <p id="mCategory"></p>
    <p id="mArea"></p>
    <p id="mTags"></p>
    <p id="mInstructions"></p>
    <button onclick="closeModal()">Close</button>
  </div>
</div>

<script>
let meals=[];
let selected=[];

// Default load (Arrabiata)
window.onload=()=>fetchByName('Arrabiata');

function fetchByName(name){
  fetch(`https://www.themealdb.com/api/json/v1/1/search.php?s=${name}`)
  .then(r=>r.json())
  .then(d=>{meals=d.meals||[];render();});
}

function fetchByLetter(letter){
  fetch(`https://www.themealdb.com/api/json/v1/1/search.php?f=${letter}`)
  .then(r=>r.json())
  .then(d=>{meals=d.meals||[];render();});
}

function fetchById(id){
  fetch(`https://www.themealdb.com/api/json/v1/1/lookup.php?i=${id}`)
  .then(r=>r.json())
  .then(d=>showModal(d.meals[0]));
}

function render(){
  const wrap=document.getElementById('mealList');
  wrap.innerHTML='';
  if(!meals.length){wrap.innerHTML='<p>Not Found</p>';return;}
  meals.forEach(m=>{
    const added=selected.find(x=>x.idMeal===m.idMeal);
    wrap.innerHTML+=`
      <div class="card">
        <img src="${m.strMealThumb}">
        <div class="card-body">
          <p><b>Name:</b> ${m.strMeal}</p>
          <p><b>Category:</b> ${m.strCategory}</p>
          <p><b>Instructions:</b> ${(m.strInstructions||'').slice(0,15)}...</p>
          <button ${added?'class="disabled"':''} onclick="add('${m.idMeal}')">${added?'Already Selected':'Add to Cart'}</button>
          <button onclick="fetchById('${m.idMeal}')">Details</button>
        </div>
      </div>`;
  });
}

function add(id){
  if(selected.length>=7){alert('Maximum 7 foods allowed');return;}
  const m=meals.find(x=>x.idMeal===id);
  if(!selected.find(x=>x.idMeal===id)){
    selected.push(m);
    document.getElementById('cart').innerHTML+=`<img src="${m.strMealThumb}" title="${m.strMeal}">`;
    document.getElementById('count').innerText=selected.length;
    render();
  }
}

function searchMeal(){
  const q=searchInput.value.trim();
  if(q.length===1){fetchByLetter(q);}else if(q){fetchByName(q);}
}

function showModal(m){
  mImg.src=m.strMealThumb;
  mName.innerText=m.strMeal;
  mCategory.innerText='Category: '+m.strCategory;
  mArea.innerText='Area: '+m.strArea;
  mTags.innerText='Tags: '+(m.strTags||'N/A');
  mInstructions.innerText='Instructions: '+m.strInstructions;
  modal.style.display='flex';
}

function closeModal(){modal.style.display='none';}
</script>
</body>
</html>